---
layout: post
title: "CTA Data Visualization"
subtitle: "Analyzing ridership data on CTA metros from 2001 to 2021"
background: '/img/posts/cta_viz/01.jpg'
---
<iframe width="560" height="315" src="https://www.youtube.com/embed/qoWCB8AUiP4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


## INTRO
This dashboard is designed to display ridership data in a simple and intuitive manner. Users can view the ridership data in three metro stations: UIC-Halsted, O'Hare Airport and Racine. 

The project was developed in R using RStudio as the development enviroment and ShinyApps to deploy the dashboard. The dashboard was designed with the intent of running on a touch-screen wall with a resolution of 5,760 x 3,240.

## PREREQUISITES
- Installation of R and RStudio is necessary to run the application.

- For this project we'll be using a couple of libraries that can be installed using 'install.packages()'
```
install.packages("lubridate")
install.packages("DT")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("tidyr")
install.packages("scales")
install.packages("shiny")
install.packages("shinydashboard")
```
## PRE-PROCESSING
The data is sourced from the [Chicago Data Portal](https://data.cityofchicago.org/Transportation/CTA-Ridership-L-Station-Entries-Daily-Totals/5neh-572f/data).
The dataset is Tab Separated Value(.tsv) file, consisting of 1.08 million rows of data and contains the following attributes:

| Column |  |Data Type |
| :-----|  |:------  |
| station_id |  |integer |
| stationname |  |string |
| date |  |Date |
| daytype |  |character |
| rides |  |integer |

We first read the data file into the R file as a data frame(cta_station) for manipulating the attributes. We then check for NULL values in the dataset.
```
ok <- complete.cases(cta_station)
dim(cta_station[ok, ]) == dim(cta_station)
```

Taking a closer look at the attributes, the date column is a character data type which we need to convert to the date format
```
cta_station$date <- as.Date(cta_station$date, '%m/%d/%Y')
```

From the date column, we can engineer new features by individually extracting the year, month and week day and storing them in separate attributes.
```
cta_station$year <- as.numeric(format(cta_station$date, format='%Y'))
cta_station$month <- as.numeric(format(cta_station$date, format='%m'))
cta_station$day <- as.numeric(format(cta_station$date, format='%d'))
cta_station$week_day <- wday(cta_station$date, label=TRUE)
```

We can also create a month_name column that holds values of the months as string
```
name_of_month <- function(df){
  df$month_name[df$month==1] <- 'Jan'
  df$month_name[df$month==2] <- 'Feb'
  df$month_name[df$month==3] <- 'Mar'
  df$month_name[df$month==4] <- 'Apr'
  df$month_name[df$month==5] <- 'May'
  df$month_name[df$month==6] <- 'Jun'
  df$month_name[df$month==7] <- 'Jul'
  df$month_name[df$month==8] <- 'Aug'
  df$month_name[df$month==9] <- 'Sep'
  df$month_name[df$month==10] <- 'Oct'
  df$month_name[df$month==11] <- 'Nov'
  df$month_name[df$month==12] <- 'Dec'
  
  return(df)
  }
  ```

By analysing the stationname column, we can observe that there are 148 uniques stations in the dataset.
```
unique(cta_station$stationname)
length(unique(cta_station$stationname))
```

For the purposes of this project, we'll only be focusing on three stations: **_UIC-Halsted_, _O'Hare Airport_ and _Racine_**. So we create subsets of the dataframe for each individual station and merge them. 
```
uic_station <- subset(cta_station, stationname == 'UIC-Halsted')
ohare_station <- subset(cta_station, stationname == 'O'Hare Airport')
racine_station <- subset(cta_station, stationname == 'Racine')

station_data <- do.call("rbind", list(uic_station, ohare_station, racine_station))
```

This is the data file we'll be using for our dashboard.

## THE DASHBOARD
![Dashboard Interface](\img\posts\cta_viz\interface.PNG)

The dashboard is divided into 4 sections:
#### THE ABOUT PAGE
![About Page](\img\posts\cta_viz\about.PNG)

Users can get a brief idea of the interface and how it's meant to be used. There's an introduction to the dataset, the link from it was sourced and a brief elaboration of the attributes.

#### STATION COMPARISON
![Table Data](\img\posts\cta_viz\comparison.png)

The section is divided into two regions, each with their own set of controls. Users can at a glance compare information between any two stations. Graphs on ridership are plotted on a yearly, daily, monthly and weekly basis. Users can change the station and the year from which the data is being visualized from the dropdowns in the sidepanel. Users can observe data of individual stations or the summarized data of all three stations. This allows users to mix and match graphs from different years allowing them to quickly spot any possible evnts of interest that may have happened at a station

#### TABLE DATA
![Table Data](\img\posts\cta_viz\table.PNG)

Users can view the visualization and tabular data of stations in the two regions of the sections. Users can choose the station, year and time frame ie. daily, weekly and monthly view of the station data from the dropdowns in the sidepanel and compare it against the station data in the opposite region. Users can pinpoint certain dates where unexpected spikes and/or declines in ridership may have occurred and infer the possible reasons behind it.

#### DATES OF INTEREST

